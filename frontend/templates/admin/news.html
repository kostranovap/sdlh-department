{% extends "base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏ - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="{{ url_for('admin.dashboard') }}">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a></li>
<li class="breadcrumb-item">–ù–æ–≤–æ—Å—Ç–∏</li>
{% endblock %}

{% block content %}
<div class="container">
    <div class="admin-page">
    <div class="page-header">
        <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏</h1>
    </div>

    <!-- –§–∏–ª—å—Ç—Ä—ã -->
    <div class="filters-section">
        <div class="filter-group">
            <a href="{{ url_for('admin.news', status='all') }}" 
               class="filter-btn {% if current_status == 'all' %}active{% endif %}">
                –í—Å–µ –Ω–æ–≤–æ—Å—Ç–∏
            </a>
            <a href="{{ url_for('admin.news', status='published') }}" 
               class="filter-btn {% if current_status == 'published' %}active{% endif %}">
                –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ
            </a>
            <a href="{{ url_for('admin.news', status='draft') }}" 
               class="filter-btn {% if current_status == 'draft' %}active{% endif %}">
                –ß–µ—Ä–Ω–æ–≤–∏–∫–∏
            </a>
            <a href="{{ url_for('admin.news', status='important') }}" 
               class="filter-btn {% if current_status == 'important' %}active{% endif %}">
                –í–∞–∂–Ω—ã–µ
            </a>
        </div>
        <div class="filter-actions">
            <a href="{{ url_for('admin.create_news') }}" class="btn-add">+ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å</a>
        </div>
    </div>

    <div class="admin-section">
        {% if news.items %}
        <div class="news-table">
            <div class="table-header">
                <span>–ó–∞–≥–æ–ª–æ–≤–æ–∫</span>
                <span>–ê–≤—Ç–æ—Ä</span>
                <span>–°—Ç–∞—Ç—É—Å</span>
                <span>–î–∞—Ç–∞</span>
                <span>–î–µ–π—Å—Ç–≤–∏—è</span>
            </div>
            
            {% for article in news.items %}
            <div class="table-row">
                <span class="news-title">
                    <strong>{{ article.title }}</strong>
                    {% if article.is_important %}
                        <span class="important-badge">–í–ê–ñ–ù–ê–Ø</span>
                    {% endif %}
                    {% if article.content %}
                        <small>{{ article.content[:80] }}{% if article.content|length > 80 %}...{% endif %}</small>
                    {% endif %}
                </span>
                <span class="news-author">{{ article.author.full_name if article.author else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</span>
                <span class="news-status status-{{ 'published' if article.is_published else 'draft' }}">
                    {{ '–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞' if article.is_published else '–ß–µ—Ä–Ω–æ–≤–∏–∫' }}
                </span>
                <span class="news-date">{{ article.created_at.strftime('%d.%m.%Y') if article.created_at else '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</span>
                <span class="news-actions">
                    <a href="{{ url_for('main.news_detail', id=article.id) }}" class="action-btn view-btn" title="–ü—Ä–æ—Å–º–æ—Ç—Ä" target="_blank">üëÅ</a>
                    <a href="{{ url_for('admin.edit_news', id=article.id) }}" class="action-btn edit-btn" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úè</a>
                    <form method="POST" action="{{ url_for('admin.delete_news', id=article.id) }}" 
                          style="display: inline;" 
                          onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –Ω–æ–≤–æ—Å—Ç—å?')">
                        <button type="submit" class="action-btn delete-btn" title="–£–¥–∞–ª–∏—Ç—å">‚úó</button>
                    </form>
                </span>
            </div>
            {% endfor %}
        </div>

        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
        {% if news.pages > 1 %}
        <div class="pagination">
            {% if news.has_prev %}
                <a href="{{ url_for('admin.news', page=news.prev_num, status=current_status) }}" 
                   class="pagination-link">‚Äπ –ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
            {% endif %}
            
            {% for page_num in news.iter_pages() %}
                {% if page_num %}
                    {% if page_num != news.page %}
                        <a href="{{ url_for('admin.news', page=page_num, status=current_status) }}" 
                           class="pagination-link">{{ page_num }}</a>
                    {% else %}
                        <span class="pagination-current">{{ page_num }}</span>
                    {% endif %}
                {% else %}
                    <span class="pagination-ellipsis">‚Ä¶</span>
                {% endif %}
            {% endfor %}
            
            {% if news.has_next %}
                <a href="{{ url_for('admin.news', page=news.next_num, status=current_status) }}" 
                   class="pagination-link">–°–ª–µ–¥—É—é—â–∞—è ‚Ä∫</a>
            {% endif %}
        </div>
        {% endif %}
        
        {% else %}
        <div class="empty-state">
            <p>–ù–æ–≤–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            <a href="{{ url_for('admin.create_news') }}" class="btn-add">+ –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –Ω–æ–≤–æ—Å—Ç—å</a>
        </div>
                 {% endif %}
     </div>
</div>
</div>

<style>
/* –ê–¥–º–∏–Ω-—Å—Ç—Ä–∞–Ω–∏—Ü—ã: –æ—Ç—Å—Ç—É–ø—ã –∏ –∫–æ–º–ø–æ–Ω–æ–≤–∫–∞ */
.admin-page {
    margin: var(--spacing-2xl) 0;
}

.page-header {
    padding-bottom: var(--spacing-lg);
    border-bottom: 1px solid var(--color-gray-200);
    margin-bottom: var(--spacing-2xl);
}

.page-header h1 {
    margin: 0;
    color: var(--color-gray-800);
}

/* –§–∏–ª—å—Ç—Ä—ã */
.filters-section {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--color-white);
    border: 1px solid var(--color-gray-200);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-2xl);
    box-shadow: var(--shadow-sm);
}

.filter-group {
    display: flex;
    gap: var(--spacing-sm);
}

.filter-btn {
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--border-radius-sm);
    text-decoration: none;
    color: var(--color-gray-600);
    background: var(--color-gray-100);
    font-size: var(--font-size-sm);
    font-weight: 500;
    transition: all var(--transition-fast);
}

.filter-btn:hover, .filter-btn.active {
    background: var(--color-primary);
    color: var(--color-white);
}

.btn-add {
    background: var(--color-primary);
    color: var(--color-white);
    padding: var(--spacing-sm) var(--spacing-lg);
    border-radius: var(--border-radius-sm);
    text-decoration: none;
    font-weight: 600;
    transition: all var(--transition-fast);
}

.btn-add:hover {
    background: var(--color-primary-dark);
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
}

/* –¢–∞–±–ª–∏—Ü–∞ –Ω–æ–≤–æ—Å—Ç–µ–π */
.news-table {
    background: var(--color-white);
    border: 1px solid var(--color-gray-200);
    border-radius: var(--border-radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
}

.table-header {
    display: grid;
    grid-template-columns: 3fr 1fr 1fr 1fr auto;
    gap: var(--spacing-lg);
    padding: var(--spacing-lg);
    background: var(--color-gray-50);
    font-weight: 600;
    color: var(--color-gray-700);
    border-bottom: 1px solid var(--color-gray-200);
}

.table-row {
    display: grid;
    grid-template-columns: 3fr 1fr 1fr 1fr auto;
    gap: var(--spacing-lg);
    align-items: center;
    padding: var(--spacing-lg);
    border-bottom: 1px solid var(--color-gray-100);
    transition: background-color var(--transition-fast);
}

.table-row:last-child {
    border-bottom: none;
}

.table-row:hover {
    background: var(--color-gray-50);
}

.news-title strong {
    display: block;
    color: var(--color-gray-800);
    font-weight: 600;
}

.news-title small {
    display: block;
    color: var(--color-gray-600);
    font-size: var(--font-size-xs);
    margin-top: var(--spacing-xs);
}

.important-badge {
    background: #fef3c7;
    color: #d97706;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: var(--font-size-xs);
    font-weight: 600;
    margin-left: var(--spacing-sm);
}

.news-status {
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--border-radius-sm);
    font-size: var(--font-size-xs);
    font-weight: 600;
    text-align: center;
}

.status-published {
    background: #e8f5e8;
    color: var(--color-primary);
}

.status-draft {
    background: #f3f4f6;
    color: #374151;
}

.news-actions {
    display: flex;
    gap: var(--spacing-xs);
    align-items: center;
}

.action-btn {
    width: 28px;
    height: 28px;
    border: none;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    text-decoration: none;
    font-size: 14px;
    transition: all var(--transition-fast);
}

.view-btn {
    background: #e3f2fd;
    color: #1976d2;
}

.view-btn:hover {
    background: #1976d2;
    color: white;
}

.edit-btn {
    background: #fff3e0;
    color: #f57c00;
}

.edit-btn:hover {
    background: #f57c00;
    color: white;
}

.delete-btn {
    background: #ffebee;
    color: #d32f2f;
}

.delete-btn:hover {
    background: #d32f2f;
    color: white;
}

/* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */
.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-2xl);
}

.pagination-link, .pagination-current {
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: 12px;
    text-decoration: none;
    font-weight: 600;
    transition: all var(--transition-base);
    box-shadow: var(--shadow-sm);
    min-width: 40px;
    text-align: center;
}

.pagination-link {
    background: var(--color-white);
    color: var(--color-gray-700);
    border: 1px solid var(--color-gray-200);
}

.pagination-link:hover {
    background: var(--color-primary);
    color: var(--color-white);
    transform: translateY(-1px);
    box-shadow: var(--shadow-md);
}

.pagination-current {
    background: var(--color-primary);
    color: var(--color-white);
}

.pagination-ellipsis {
    color: var(--color-gray-400);
    padding: var(--spacing-sm);
}

.empty-state {
    text-align: center;
    padding: var(--spacing-2xl);
    color: var(--color-gray-600);
}

.empty-state p {
    margin-bottom: var(--spacing-lg);
}
</style>
{% endblock %} 