{% extends "admin/base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏{% endblock %}

{% block content %}
<div class="admin-content">
    <div class="admin-header">
        <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç—è–º–∏</h1>
        <div class="admin-actions">
            <a href="{{ url_for('admin.create_news') }}" class="btn btn-primary">
                <i class="icon-plus"></i> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å
            </a>
        </div>
    </div>

    {% if news.items %}
    <div class="admin-stats">
        <div class="stat-item">
            <span class="stat-number">{{ news.total }}</span>
            <span class="stat-label">–í—Å–µ–≥–æ –Ω–æ–≤–æ—Å—Ç–µ–π</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">{{ news.items | selectattr('is_published') | list | length }}</span>
            <span class="stat-label">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</span>
        </div>
        <div class="stat-item">
            <span class="stat-number">{{ news.items | selectattr('is_important') | list | length }}</span>
            <span class="stat-label">–í–∞–∂–Ω—ã—Ö</span>
        </div>
    </div>

    <div class="admin-table-container">
        <table class="admin-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</th>
                    <th>–ó–∞–≥–æ–ª–æ–≤–æ–∫</th>
                    <th>–ê–≤—Ç–æ—Ä</th>
                    <th>–ü—Ä–æ—Å–º–æ—Ç—Ä—ã</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                </tr>
            </thead>
            <tbody>
                {% for article in news.items %}
                <tr>
                    <td>{{ article.id }}</td>
                    <td class="image-cell">
                        {% if article.image_url %}
                            <img src="{{ article.image_url }}" alt="–ü—Ä–µ–≤—å—é" class="table-image">
                        {% else %}
                            <div class="no-image">üì∞</div>
                        {% endif %}
                    </td>
                    <td>
                        <div class="article-title">
                            <strong>{{ article.title }}</strong>
                            {% if article.is_important %}
                                <span class="important-badge">–í–∞–∂–Ω–∞—è</span>
                            {% endif %}
                        </div>
                        {% if article.summary %}
                            <div class="article-summary">{{ article.summary[:100] }}{% if article.summary|length > 100 %}...{% endif %}</div>
                        {% endif %}
                    </td>
                    <td>{{ article.author.full_name if article.author else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</td>
                    <td>
                        <span class="view-count">{{ article.view_count or 0 }}</span>
                    </td>
                    <td>
                        <span class="status-badge {% if article.is_published %}status-published{% else %}status-draft{% endif %}">
                            {% if article.is_published %}–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞{% else %}–ß–µ—Ä–Ω–æ–≤–∏–∫{% endif %}
                        </span>
                    </td>
                    <td>{{ article.created_at.strftime('%d.%m.%Y %H:%M') if article.created_at else '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                    <td class="actions">
                        <a href="{{ url_for('main.news_detail', id=article.id) }}" class="btn btn-sm btn-outline-info" target="_blank">
                            <i class="icon-eye"></i> –ü—Ä–æ—Å–º–æ—Ç—Ä
                        </a>
                        <a href="{{ url_for('admin.edit_news', id=article.id) }}" class="btn btn-sm btn-outline-primary">
                            <i class="icon-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å
                        </a>
                        <form method="POST" action="{{ url_for('admin.delete_news', id=article.id) }}" 
                              style="display: inline;" 
                              onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –Ω–æ–≤–æ—Å—Ç—å?')">
                            <button type="submit" class="btn btn-sm btn-outline-danger">
                                <i class="icon-delete"></i> –£–¥–∞–ª–∏—Ç—å
                            </button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è -->
    {% if news.pages > 1 %}
    <div class="pagination-container">
        <nav class="pagination">
            {% if news.has_prev %}
                <a href="{{ url_for('admin.news', page=news.prev_num) }}" class="page-link">
                    <i class="icon-arrow-left"></i> –ü—Ä–µ–¥—ã–¥—É—â–∞—è
                </a>
            {% endif %}
            
            {% for page_num in news.iter_pages() %}
                {% if page_num %}
                    {% if page_num != news.page %}
                        <a href="{{ url_for('admin.news', page=page_num) }}" class="page-link">{{ page_num }}</a>
                    {% else %}
                        <span class="page-link current">{{ page_num }}</span>
                    {% endif %}
                {% else %}
                    <span class="page-link disabled">...</span>
                {% endif %}
            {% endfor %}
            
            {% if news.has_next %}
                <a href="{{ url_for('admin.news', page=news.next_num) }}" class="page-link">
                    –°–ª–µ–¥—É—é—â–∞—è <i class="icon-arrow-right"></i>
                </a>
            {% endif %}
        </nav>
    </div>
    {% endif %}

    {% else %}
    <!-- –ü—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ -->
    <div class="empty-state">
        <div class="empty-icon">üì∞</div>
        <h3>–ù–æ–≤–æ—Å—Ç–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
        <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞.</p>
        <a href="{{ url_for('admin.create_news') }}" class="btn btn-primary btn-lg">
            <i class="icon-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—É—é –Ω–æ–≤–æ—Å—Ç—å
        </a>
    </div>
    {% endif %}
</div>

<style>
.admin-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-item {
    padding: 1.5rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    text-align: center;
}

.stat-number {
    display: block;
    font-size: 2rem;
    font-weight: bold;
    color: #2563eb;
    margin-bottom: 0.5rem;
}

.stat-label {
    color: #666;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.image-cell {
    width: 60px;
    padding: 0.5rem;
}

.table-image {
    width: 50px;
    height: 50px;
    object-fit: cover;
    border-radius: 4px;
    border: 1px solid #e5e7eb;
}

.no-image {
    width: 50px;
    height: 50px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f3f4f6;
    border-radius: 4px;
    font-size: 1.5rem;
    color: #9ca3af;
}

.article-title {
    margin-bottom: 0.25rem;
}

.important-badge {
    display: inline-block;
    padding: 2px 6px;
    background: #fbbf24;
    color: #92400e;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: 4px;
    margin-left: 0.5rem;
}

.article-summary {
    font-size: 0.875rem;
    color: #666;
    line-height: 1.4;
}

.view-count {
    font-weight: 500;
    color: #059669;
}

.status-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
}

.status-published {
    background: #dcfce7;
    color: #166534;
}

.status-draft {
    background: #f3f4f6;
    color: #374151;
}

.actions {
    white-space: nowrap;
}

.actions form {
    margin-left: 0.5rem;
}

.empty-state {
    text-align: center;
    padding: 4rem 2rem;
    color: #666;
}

.empty-icon {
    font-size: 4rem;
    margin-bottom: 1.5rem;
}

.empty-state h3 {
    margin-bottom: 0.5rem;
    color: #333;
    font-size: 1.5rem;
}

.empty-state p {
    margin-bottom: 2rem;
    font-size: 1.1rem;
}

/* Responsive */
@media (max-width: 768px) {
    .admin-stats {
        grid-template-columns: 1fr;
    }
    
    .admin-table {
        font-size: 0.875rem;
    }
    
    .image-cell {
        display: none;
    }
    
    .actions .btn {
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
    }
}
</style>
{% endblock %} 