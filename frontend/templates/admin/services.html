{% extends "base.html" %}

{% block title %}–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª—É–≥–∞–º–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏ - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å{% endblock %}

{% block breadcrumb_items %}
<li class="breadcrumb-item"><a href="{{ url_for('admin.dashboard') }}">–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a></li>
<li class="breadcrumb-item">–£—Å–ª—É–≥–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã</li>
{% endblock %}

{% block content %}
<div class="container">
    <div class="admin-content">
    <div class="admin-header">
        <h1>–£—Å–ª—É–≥–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã</h1>
        <div class="admin-actions">
            <a href="{{ url_for('admin.add_service') }}" class="btn btn-primary">
                <i class="icon-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —É—Å–ª—É–≥—É
            </a>
            <a href="{{ url_for('admin.add_program') }}" class="btn btn-success">
                <i class="icon-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É
            </a>
        </div>
    </div>

    <!-- –£—Å–ª—É–≥–∏ -->
    <div class="admin-section">
        <h2>–£—Å–ª—É–≥–∏ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞ ({{ services.total }} –≤—Å–µ–≥–æ)</h2>
        
        {% if services.items %}
        <div class="admin-table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–°—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏</th>
                        <th>–°—Ç–æ–∏–º–æ—Å—Ç—å</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for service in services.items %}
                    <tr>
                        <td>{{ service.id }}</td>
                        <td><strong>{{ service.name }}</strong></td>
                        <td class="text-truncate">{{ service.description[:100] }}{% if service.description|length > 100 %}...{% endif %}</td>
                        <td>{{ service.processing_time or '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td>{{ service.cost or '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td>
                            <span class="status-badge {% if service.is_active %}status-active{% else %}status-inactive{% endif %}">
                                {% if service.is_active %}–ê–∫—Ç–∏–≤–Ω–∞{% else %}–ù–µ–∞–∫—Ç–∏–≤–Ω–∞{% endif %}
                            </span>
                        </td>
                        <td>{{ service.created_at.strftime('%d.%m.%Y') if service.created_at else '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td class="actions">
                            <a href="{{ url_for('admin.edit_service', id=service.id) }}" class="btn btn-sm btn-outline-primary">
                                <i class="icon-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å
                            </a>
                            <form method="POST" action="{{ url_for('admin.delete_service', id=service.id) }}" 
                                  style="display: inline;" 
                                  onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É —É—Å–ª—É–≥—É?')">
                                <button type="submit" class="btn btn-sm btn-outline-danger">
                                    <i class="icon-delete"></i> –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –¥–ª—è —É—Å–ª—É–≥ -->
        {% if services.pages > 1 %}
        <div class="pagination-container">
            <nav class="pagination">
                {% if services.has_prev %}
                    <a href="{{ url_for('admin.services_programs', page=services.prev_num) }}" class="page-link">
                        <i class="icon-arrow-left"></i> –ü—Ä–µ–¥—ã–¥—É—â–∞—è
                    </a>
                {% endif %}
                
                {% for page_num in services.iter_pages() %}
                    {% if page_num %}
                        {% if page_num != services.page %}
                            <a href="{{ url_for('admin.services_programs', page=page_num) }}" class="page-link">{{ page_num }}</a>
                        {% else %}
                            <span class="page-link current">{{ page_num }}</span>
                        {% endif %}
                    {% else %}
                        <span class="page-link disabled">...</span>
                    {% endif %}
                {% endfor %}
                
                {% if services.has_next %}
                    <a href="{{ url_for('admin.services_programs', page=services.next_num) }}" class="page-link">
                        –°–ª–µ–¥—É—é—â–∞—è <i class="icon-arrow-right"></i>
                    </a>
                {% endif %}
            </nav>
        </div>
        {% endif %}

        {% else %}
        <div class="empty-state">
            <div class="empty-icon">üìã</div>
            <h3>–£—Å–ª—É–≥–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —É—Å–ª—É–≥ –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–∞.</p>
            <a href="{{ url_for('admin.add_service') }}" class="btn btn-primary">
                <i class="icon-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é —É—Å–ª—É–≥—É
            </a>
        </div>
        {% endif %}
    </div>

    <!-- –ü—Ä–æ–≥—Ä–∞–º–º—ã -->
    <div class="admin-section">
        <h2>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã ({{ programs.total }} –≤—Å–µ–≥–æ)</h2>
        
        {% if programs.items %}
        <div class="admin-table-container">
            <table class="admin-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                        <th>–§–∏–Ω–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–∏–µ</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for program in programs.items %}
                    <tr>
                        <td>{{ program.id }}</td>
                        <td><strong>{{ program.name }}</strong></td>
                        <td class="text-truncate">{{ program.description[:100] }}{% if program.description|length > 100 %}...{% endif %}</td>
                        <td>{{ program.duration or '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td>{{ program.funding or '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td>
                            <span class="status-badge {% if program.is_active %}status-active{% else %}status-inactive{% endif %}">
                                {% if program.is_active %}–ê–∫—Ç–∏–≤–Ω–∞{% else %}–ù–µ–∞–∫—Ç–∏–≤–Ω–∞{% endif %}
                            </span>
                        </td>
                        <td>{{ program.created_at.strftime('%d.%m.%Y') if program.created_at else '–ù–µ —É–∫–∞–∑–∞–Ω–æ' }}</td>
                        <td class="actions">
                            <a href="{{ url_for('admin.edit_program', id=program.id) }}" class="btn btn-sm btn-outline-primary">
                                <i class="icon-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å
                            </a>
                            <form method="POST" action="{{ url_for('admin.delete_program', id=program.id) }}" 
                                  style="display: inline;" 
                                  onsubmit="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—É?')">
                                <button type="submit" class="btn btn-sm btn-outline-danger">
                                    <i class="icon-delete"></i> –£–¥–∞–ª–∏—Ç—å
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="empty-state">
            <div class="empty-icon">üå±</div>
            <h3>–ü—Ä–æ–≥—Ä–∞–º–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</h3>
            <p>–ü–æ–∫–∞ –Ω–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º.</p>
            <a href="{{ url_for('admin.add_program') }}" class="btn btn-success">
                <i class="icon-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—É—é –ø—Ä–æ–≥—Ä–∞–º–º—É
            </a>
        </div>
        {% endif %}
    </div>
</div>
</div>

<style>
.admin-section {
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.admin-section h2 {
    margin-bottom: 1rem;
    color: #333;
    font-size: 1.25rem;
}

.text-truncate {
    max-width: 200px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.status-badge {
    padding: 4px 8px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: uppercase;
}

.status-active {
    background: #dcfce7;
    color: #166534;
}

.status-inactive {
    background: #fef2f2;
    color: #dc2626;
}

.actions {
    white-space: nowrap;
}

.actions form {
    margin-left: 0.5rem;
}

.empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: #666;
}

.empty-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
}

.empty-state h3 {
    margin-bottom: 0.5rem;
    color: #333;
}

.empty-state p {
    margin-bottom: 1.5rem;
}
</style>
{% endblock %} 